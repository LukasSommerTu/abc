<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   <extension
         id="org.jastadd.plugin.jastaddNature"
         name="JastAdd Nature"
         point="org.eclipse.core.resources.natures">
      <runtime>
         <run class="org.jastadd.plugin.resources.JastAddNature"/>
      </runtime>
      <builder id="org.jastadd.plugin.jastaddBuilder"/>
   </extension>

   <extension
         id="jastaddBuilder"
         name="JastAdd Builder"
         point="org.eclipse.core.resources.builders">         
<!--         
    <extension
         id="org.jastadd.plugin.jastaddBuilder"
         name="JastAdd Builder"
         point="org.eclipse.core.resources.builders">
-->         
      <builder hasNature="true">
         <run class="org.jastadd.plugin.builder.JastAddBuilder"/>
      </builder>
   </extension>
   
       
   <extension
      point="org.eclipse.debug.core.breakpoints">
    <breakpoint
        class="org.jastadd.plugin.debug.JastAddBreakpoint"
        id="org.jastadd.plugin.debug.jastaddBreakpoint"
        markerType="org.jastadd.plugin.debug.jastaddBreakpointMarker"
        name="JastAdd Breakpoint"/>
   </extension>
   
   <extension 
     id="org.jastadd.plugin.debug.jastaddBreakpointMarker" 
     name="JastAdd Breakpoint Marker"
     point="org.eclipse.core.resources.markers">
	<super type="org.eclipse.debug.core.breakpointMarker"/>
   </extension>
   
   
   <extension
         id="org.jastadd.plugin.marker.ErrorMarker"
         name="JastAdd Error"
         point="org.eclipse.core.resources.markers">
      <super
            type="org.eclipse.core.resources.problemmarker">
      </super>
      <persistent
            value="true">
      </persistent>
   </extension>
      <extension
         id="org.jastadd.plugin.marker.ParseErrorMarker"
         name="JastAdd Parse Error"
         point="org.eclipse.core.resources.markers">
      <super
            type="org.eclipse.core.resources.problemmarker">
      </super>
      <persistent
            value="true">
      </persistent>
   </extension>   
   
   <extension point = "org.eclipse.debug.core.launchConfigurationTypes">
   <launchConfigurationType
         delegate="org.jastadd.plugin.launcher.JastAddLaunchDelegate"
         id="org.jastadd.plugin.launchConfigurationType"
         modes="run, debug"
         name="JastAdd Launcher">
   </launchConfigurationType>
	</extension>
   
	<extension point="org.eclipse.debug.ui.launchConfigurationTabGroups">
    	<launchConfigurationTabGroup
        	type="org.jastadd.plugin.launchConfigurationType"
        	class="org.jastadd.plugin.launcher.JastAddTabGroup"
        	id="org.jastadd.plugin.launcher.TabGroup">
    	</launchConfigurationTabGroup>
	</extension>
   
   <extension
         point="org.eclipse.ui.editors">
      <editor
            class="org.jastadd.plugin.editor.JastAddEditor"
            extensions="java"
            icon="icons/obj16/java.gif"
            id="org.jastadd.plugin.editor.JastAddEditor"
            name="JastAdd Editor">
      </editor>
   </extension>
   
  <extension
         point="org.eclipse.ui.editorActions">
      <editorContribution
            targetID="org.jastadd.plugin.editor.JastAddEditor"
            id="org.jastadd.plugin.editor.JastAddEditor.BreakpointRulerActions">
         <action
               label="%AddBreakpoint.label"
               class="org.eclipse.debug.ui.actions.RulerToggleBreakpointActionDelegate"
               actionID="RulerDoubleClick"
               id="org.jastadd.plugin.editor.actions.ManageBreakpointRulerAction">
         </action>
      </editorContribution>
   </extension>
   
   <extension
         point="org.eclipse.ui.propertyPages">
      <page
            objectClass="org.eclipse.core.resources.IProject"
            name="JastAdd Build Path"        
            class="org.jastadd.plugin.builder.JastAddBuildPathsPropertyPage"
            id="org.jastadd.plugin.builder.jastaddBuildPathsPropertyPage">
         <filter
               name="nature"
               value="org.jastadd.plugin.jastaddNature">
         </filter>
       <!--  <keywordReference id="org.eclipse.jdt.ui.buildpath"/> -->
      </page>
   </extension>
   
   
   <extension point="org.eclipse.ui.ide.resourceFilters" 
         name="org.jastadd.plugin.classfilter">
      <filter pattern="*.class" selected="true"/>
   </extension>
   
   <extension
         point="org.eclipse.ui.perspectives">
      <perspective
            class="org.jastadd.plugin.perspective.PerspectiveFactory"
            id="org.jastadd.plugin.perspective"
            name="JastAdd">
      </perspective>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            class="org.jastadd.plugin.navigator.ResourceNavigator"
            id="org.jastadd.plugin.navigator"
            name="JastAddNavigator">
      </view>
   </extension>
   
	<extension point = "org.eclipse.ui.ide.projectNatureImages">
		<image id = "org.eclipse.ui.jastAddNatureImage" 
			natureId = "org.jastadd.plugin.jastaddNature"
			icon = "icons/eview16/projects.gif">
		</image>
	</extension>
	
	<extension point = "org.eclipse.ui.newWizards">
 		<wizard id = "org.jastadd.plugin.wizards.newProjectWizard"
			name = "New JastAdd Project"
			icon = "icons/obj16/ja_fldr_obj.gif"
			preferredPerspectives = "org.jastadd.plugin.perspective"
            project="true"
            finalPerspective="org.jastadd.plugin.perspective"
			class = "org.jastadd.plugin.wizards.NewProjectWizard">
 			<description>
              Create a new JastAdd project
 			</description>
 			<selection class = "org.eclipse.core.resources.IResource"/>
		</wizard>
	</extension>
	
	
	<extension 
		point="org.eclipse.search.searchResultViewPages"
		id="JastAddSearchResultPage">
	<viewPage
		id="org.jastadd.plugin.search.JastAddSearchResultPage"
		searchResultClass="org.jastadd.plugin.search.JastAddSearchResult"
		class="org.jastadd.plugin.search.JastAddSearchResultPage">
	</viewPage>
	</extension>
	
	
	
	
	

<!-- Actions/Commands/Contexts/Menus -->

   <extension
         point="org.eclipse.ui.contexts">
      <context
            name="Editing JastAdd Source"
            description="Editing JastAdd Source"
            parentId="org.eclipse.ui.textEditorScope"
            id="org.jastadd.plugin.jastAddEditorScope">
      </context>
   </extension>
	    
   <extension
         point="org.eclipse.ui.commands">
      <category
            name="Source"
            description="JastAdd Source"
            id="org.jastadd.plugin.category.source">
      </category>
      <command
            name="Find Declaration"
            id="org.jastadd.plugin.search.declaration"
            description="JastAdd Find Declaration"
            categoryId="org.eclipse.ui.category.source">
      </command>
      <command
            name="Find References"
            id="org.jastadd.plugin.search.references"
            description="JastAdd Find References"
            categoryId="org.jastadd.plugin.category.source">
      </command>
      <command
            name="Find Implements"
            id="org.jastadd.plugin.search.implements"
            description="JastAdd Find Implements"
            categoryId="org.jastadd.plugin.category.source">
      </command>
   </extension>
   
   <extension
      point="org.eclipse.ui.handlers">
   		<handler
         	class="org.jastadd.plugin.editor.actions.FindDeclarationHandler"
         	commandId="org.jastadd.plugin.search.declaration">
      		<activeWhen>
         		<with variable="activeContexts">
            	<iterate operator="or">
               		<equals value="org.jastadd.plugin.jastAddEditorScope"/>
            	</iterate>
         		</with>
      		</activeWhen>
   		</handler>
   		<handler
         	class="org.jastadd.plugin.editor.actions.FindReferencesHandler"
         	commandId="org.jastadd.plugin.search.references">
      		<activeWhen>
         		<with variable="activeContexts">
            	<iterate operator="or">
               		<equals value="org.jastadd.plugin.jastAddEditorScope"/>
            	</iterate>
         		</with>
      		</activeWhen>
   		</handler>
   		<handler
         	class="org.jastadd.plugin.editor.actions.FindImplementsHandler"
         	commandId="org.jastadd.plugin.search.implements">
      		<activeWhen>
         		<with variable="activeContexts">
            	<iterate operator="or">
               		<equals value="org.jastadd.plugin.jastAddEditorScope"/>
            	</iterate>
         		</with>
      		</activeWhen>
   		</handler>
   		
	</extension>
	
   <extension point = "org.eclipse.ui.bindings">
   		<key sequence = "F3"
			commandId = "org.jastadd.plugin.search.declaration"
			schemeId = "org.eclipse.ui.defaultAcceleratorConfiguration"
			contextId = "org.jastadd.plugin.jastAddEditorScope"/>
   		<key sequence = "F4"
			commandId = "org.jastadd.plugin.search.references"
			schemeId = "org.eclipse.ui.defaultAcceleratorConfiguration"
			contextId = "org.jastadd.plugin.jastAddEditorScope"/>
		<key sequence = "F5"
			commandId = "org.jastadd.plugin.search.implements"
			schemeId = "org.eclipse.ui.defaultAcceleratorConfiguration"
			contextId = "org.jastadd.plugin.jastAddEditorScope"/>
	</extension>	

   <extension
         point="org.eclipse.ui.popupMenus">
         
      <objectContribution
            adaptable="true"
            objectClass="org.eclipse.core.resources.IProject"
            nameFilter="*"
            id="org.jastadd.plugin.contribution1">
         <action
               label="Toggle JastAdd Nature"
               class="org.jastadd.plugin.resources.actions.ToggleNatureAction"
               menubarPath="additions"
               enablesFor="+"
               id="org.jastadd.plugin.addRemoveNatureAction">
         </action>
      </objectContribution>
     
      <viewerContribution 
         	id="org.jastadd.plugin.editor.JastAddPopupAction"
			targetID="#TextEditorContext">

         <menu
           	id="org.jastadd.plugin.editor.JastAddFindMenu"
           	label="Find"
           	path="additions">
        	<separator name="findGroup"/>
        </menu>

        <action
           	id="org.jastadd.plugin.editor.jastAddFindImplAction" 
           	label="Implements"
           	menubarPath="org.jastadd.plugin.editor.JastAddFindMenu/findGroup"
           	definitionId="org.jastadd.plugin.search.implements"
           	class="org.jastadd.plugin.editor.actions.FindImplementsHandler">
        </action> 

        <action 
        	id="org.jastadd.plugin.editor.jastAddFindRefAction" 
	        label="References"
            menubarPath="org.jastadd.plugin.editor.JastAddFindMenu/findGroup"
        	class="org.jastadd.plugin.editor.actions.FindReferencesHandler"
	        definitionId="org.jastadd.plugin.search.references"> 
        </action> 
        
        <action id="org.jastadd.plugin.editor.jastAddFindDeclAction" 
           label="Declaration"
           menubarPath="org.jastadd.plugin.editor.JastAddFindMenu/findGroup"
           class="org.jastadd.plugin.editor.actions.FindDeclarationHandler"
           definitionId="org.jastadd.plugin.search.declaration"> 
        </action>
                
      </viewerContribution>
   </extension>
	
	
	<extension point="org.eclipse.ui.actionSets">
 		<actionSet id="org.jastadd.plugin.search.actionSet"
 				label="JastAdd Search Actions"
            	visible="false">
         		<menu
                    label="Search"
 		       		path="navigate"
               		id="org.eclipse.search.menu">
					<groupMarker name="internalDialogGroup"/>   
					<groupMarker name="dialogGroup"/>           
					<separator name="fileSearchContextMenuActionsGroup"/> 
	         		<separator name="contextMenuActionsGroup"/> 
	         		<separator name="occurencesActionsGroup"/> 
	         		<separator name="extraSearchGroup"/> 
         		</menu>
    
         		<action
               		label="Find implements"
               		class="org.jastadd.plugin.editor.actions.FindImplementsHandler"
               		menubarPath="org.eclipse.search.menu/dialogGroup"
               		id="org.jastadd.plugin.search.FindImplementsAction">
         		</action>
         		
         		<action
               		label="Find references"
               		class="org.jastadd.plugin.editor.actions.FindReferencesHandler"
               		menubarPath="org.eclipse.search.menu/dialogGroup"
               		id="org.jastadd.plugin.search.FindReferencesAction">
         		</action>
         		
         		<action
               		label="Find declarations"
               		class="org.jastadd.plugin.editor.actions.FindDeclarationHandler"
               		menubarPath="org.eclipse.search.menu/dialogGroup"
               		definitionId="org.jastadd.plugin.search.declaration"
               		id="org.jastadd.plugin.search.FindDeclarationAction">
         		</action>
 		</actionSet>
	</extension>
	
	
	<extension
         point="org.eclipse.ui.actionSetPartAssociations">
      <actionSetPartAssociation
            targetID="org.jastadd.plugin.search.actionSet">
         <part id="org.jastadd.plugin.editor.JastAddEditor">
         </part>
      </actionSetPartAssociation>
   </extension>
   
</plugin>
