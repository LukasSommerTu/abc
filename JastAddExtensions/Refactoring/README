The Refactoring Tool is part of the JastAdd project (http://www.jastadd.org)
The source code copyright is held by Max Schäfer and Torbjörn Ekman.

The source code is covered by a modified BSD license. Details on licences for
the other tools are available in their respective folders.

Building:
=========
Make sure that projects Analyses, Java1.4Frontend, Java1.5Frontend, and
IntertypeDeclarations are unpacked into sibling directories of this one, then
do `ant clean' to be on the safe side. These projects are all included in the
web distribution. There are two buildfiles: build.xml for refactoring Java 5,
and buildITD.xml to include support for AspectJ like inter-type declarations.

The most commonly used ant goals in build.xml are:
gen 	   run JastAdd no generate node definitions and the scanner and
		   parser; does not compile the resulting Java code
build	   first runs gen, then compiles all Java files in all subdirs
		   except tests/ and tools/
cleanGen   deletes all generated Java code and subdirectories

To get include support for inter-type declarations, use buildITD.xml instead
and make sure that IntertypeDeclarations is unpacked into a sibling directory
as well.

Executing Refactorings from the Command Line:
=============================================

In subdirectory main/, there are driver programs RenameField, RenameType, RenameLocalVariable, RenameVariable, and EncapsulateField to run refactorings from the command line.

For example, to rename type p.A in the first RenameType test to B, execute

  java main.RenameType p A B tests/data/RenameType/test1/in/A.java

and similar for the other drivers (see source files for details about argument syntax).

Note, however, that these tools will only perform refactorings on the in-memory representation of the program; it will never touch the actual on-disk files.

What is where:
=============
./*.jrag ./*.jadd: implementation of the refactoring code; notably
	 	   - Access*.jrag: implements attributes to build accesses
		           to different sorts of declarations from
				   some point in the AST; the code parallels the corresponding
				   Lookup* attributes' structure
           - *AccessInfo.jrag: the access code at first only generates
                   symbolic representations of the accesses; from these,
                   actual accesses are generated by the code in these aspects
		   - AdjustAccess.jrag: implements an adjustment table, which
		           keeps track of a list of accesses and the
				   declarations they should point to; the table
				   can then run through the list and try and
				   make the declarations point to their
				   recorded destinations
		   - AddMethod.jrag: add a method to a class, checking for
		           name clashes and (optionally) possible
				   capture and overriding
           - LocalVarNesting.jrag: checks whether a local variable
		           can be added to a certain block without
				   provoking name clashes
		   - Overriding.jrag: find the overriding and overridden
		     	   methods for a method declaration
           - Uses.jrag:    find all the use sites of an entity
           - Encapsulate.jrag: the Encapsulate Field refactoring
           - ExtractBlock.jrag: the first half of the Extract Method
		           refactoring, which takes a chunk of code
				   and turns it into a block, possibly
				   moving declarations outside if they are
				   referenced after the chunk in question
           - MakeMethod.jrag: the second half, which turns the
		           newly created block into a method of its
				   own
           - Rename*.jrag: implements several flavours of renaming
           - Names.jrag:   implements a general interface for changing
		     	   the name of an entity
           - PackageName.ast: implements package declarations
           - Undo.jadd: this aspect implements an (almost oblivious)
		     	   undo facility on ASTs so that refactorings
				   can change the tree without having to
				   worry about how to restore the previous
				   state if there is an error
           - FileRange.jrag: a FileRange represents a range of
		           characters in a file; used for error
				   reporting and testing
           - Callable.jrag: a callable is either a method or
		     	   a constructor
           - Changes.jrag: abstract representations of AST changes, 
                   plus a class for refactoring exceptions; such 
                   exceptions are thrown when a refactoring discovers
                   that it cannot succeed
main/	   some command line tools for testing out refactorings
tests/	   JUnit tests for different parts of the code; see tests/README
		   for details
AST/, beaver/, parser/, scanner/  code generated by JastAdd

